// SPDX-License-Identifier: MIT
pragma solidity ^0.8.10;

import "./ProofLib.sol";

contract MassUpdateVerifier {
    using ProofLib for ProofLib.G1Point;
    using ProofLib for ProofLib.G2Point;

    function massUpdateVerifyingKey() internal pure returns (ProofLib.VerifyingKey memory vk) {
        vk.alfa1 = ProofLib.G1Point(
            20491192805390485299153009773594534940189261866228447918068658471970481763042,
            9383485363053290200918347156157836566562967994039712273449902621266178545958
        );

        vk.beta2 = ProofLib.G2Point(
            [4252822878758300859123897981450591353533073413197771768651442665752259397132,
             6375614351688725206403948262868962793625744043794305715222011528459656738731],
            [21847035105528745403288232691147584728191162732299865338377159692350059136679,
             10505242626370262277552901082094356697409835680220590971873171140371331206856]
        );
        vk.gamma2 = ProofLib.G2Point(
            [11559732032986387107991004021392285783925812861821192530917403151452391805634,
             10857046999023057135944570762232829481370756359578518086990519993285655852781],
            [4082367875863433681332203403145435568316851327593401208105741076214120093531,
             8495653923123431417604973247489272438418190587263600148770280649306958101930]
        );
        vk.delta2 = ProofLib.G2Point(
            [19489580543998602386304898476910749544730198837251147143117354480123805709723,
             9542804278347414315163254372694976846349443851866472730619683933155518662040],
            [1419382413758392212870088987256615099380437156301023182876348247735552361616,
             1768704390115074909149144181663365893741015205473153336008959231943756774374]
        );
        vk.IC = new ProofLib.G1Point[](52);
        
        vk.IC[0] = ProofLib.G1Point( 
            10627050596247990680473223444386507156120444393533595296313335296405758343128,
            4210905543607226746253180590481649633023358720626209086561009779191023874250
        );                                      
        
        vk.IC[1] = ProofLib.G1Point( 
            9586788968047020395238039084951885916435814417307782881703886812618090701821,
            15474206990795324052126823732492629126414684221307428507957709718699904236095
        );                                      
        
        vk.IC[2] = ProofLib.G1Point( 
            15022902070024113441005020304941250434438303256637187535372750979071040226991,
            1614807456011209228243167856163220594502977320760961386622612162114593625276
        );                                      
        
        vk.IC[3] = ProofLib.G1Point( 
            8918658006787837916841973140930783609561764440699167381918584796072101301305,
            21690358166767175299674457363006458584281474152789661685098909128428143076812
        );                                      
        
        vk.IC[4] = ProofLib.G1Point( 
            21411876051885511607500847849647603377881224390874003639118143926895757544765,
            5591813509863125081293595303988460256359658082365662341843449804472481243522
        );                                      
        
        vk.IC[5] = ProofLib.G1Point( 
            13708852488580303210756782491611810048153597501943888793465151840104136902312,
            15626018714378728922597112308901341352502356837031887063893974090673225750598
        );                                      
        
        vk.IC[6] = ProofLib.G1Point( 
            1001301125605202012638248160438613172107861207508778062979179503456161851566,
            15694640816087455582847570564991628225528478609868840604606503825064664474262
        );                                      
        
        vk.IC[7] = ProofLib.G1Point( 
            10218962161076781458812719379551287130147787664134039810168947581878138432417,
            20017230036178780763728353156445030758326294200113164444650381229058421800897
        );                                      
        
        vk.IC[8] = ProofLib.G1Point( 
            16754598518358875013341376375842856138858779034025364380403690539304803762044,
            16224355004926724256967780954238218870424710600124740621807004767824066552461
        );                                      
        
        vk.IC[9] = ProofLib.G1Point( 
            15741297865981733115050488308162424655828916320844806259161607672245698277484,
            16637812053819069057599777448270794918320891457561116083106694869248451140591
        );                                      
        
        vk.IC[10] = ProofLib.G1Point( 
            15892194177082362522387791201934503615238128994298552162974381610667957389034,
            8176459613232674135935079442038884692826664417179594471608600430537914720161
        );                                      
        
        vk.IC[11] = ProofLib.G1Point( 
            10247603744789691140660244783037069938077348973652701556116365107691824239380,
            524767193708381482910853803275423900846069663885392467188937985941237114038
        );                                      
        
        vk.IC[12] = ProofLib.G1Point( 
            18286337403086876367622149746674200819094043741357329288260692558085267661840,
            15350882891581817060467388261263944164709425998737321300892717993821876174789
        );                                      
        
        vk.IC[13] = ProofLib.G1Point( 
            1872773189087369245219608128408989645433650247484033117423108263159547260971,
            9138394891304166398792531299915926752709084786196544289840967979056359043968
        );                                      
        
        vk.IC[14] = ProofLib.G1Point( 
            5725081413153162447323254181625586942859692253436042277286130764238951248781,
            1589078269194202724588258361899355194713141268660820737100449306530533337057
        );                                      
        
        vk.IC[15] = ProofLib.G1Point( 
            15827979423001561416820697155781298163844412480199417749778298244565715964534,
            1109365128664093956587291018675830391674885629070342125384500743050961518708
        );                                      
        
        vk.IC[16] = ProofLib.G1Point( 
            9341365223738656578875194758784639066298446608916828171548730892502947817866,
            14901196360492588484163829311069780839309112073940493853499759179967481689428
        );                                      
        
        vk.IC[17] = ProofLib.G1Point( 
            12045130344689167548014975367339315563203931377847840829513918705454722543755,
            3274918810577619658037712904737108584713846731536778021439815553260190473635
        );                                      
        
        vk.IC[18] = ProofLib.G1Point( 
            16160465664210691728894936380675665446510976482340077251671758987955339890397,
            5379200022556513156622637389568135390208869663304664254635771789663956046705
        );                                      
        
        vk.IC[19] = ProofLib.G1Point( 
            4850275169656516527953452920931489237786687385866276680596908641211422045334,
            18857632207055518346931336852134215970236579400045199080167800000478766286574
        );                                      
        
        vk.IC[20] = ProofLib.G1Point( 
            10896734632395873565624931566747527167945265028123955570770268161598178213652,
            13798117615858201698090438902929218138069159957431797765549861419688940860115
        );                                      
        
        vk.IC[21] = ProofLib.G1Point( 
            18500880846871542140523423171756659625741133992107499897228936425946627239886,
            7223795356867592422529740671684338009714353252833818884781279939149556104902
        );                                      
        
        vk.IC[22] = ProofLib.G1Point( 
            4258605345564961039205775068528453949238221947386397414690299721703538282077,
            18217495923340063876905897534630706529809649163160403732102834376980741688196
        );                                      
        
        vk.IC[23] = ProofLib.G1Point( 
            17719834007487910643739652266973987878353001581528004507524189660697653321658,
            18000657889396167920597357153155491204957183258047965553985660039615172843886
        );                                      
        
        vk.IC[24] = ProofLib.G1Point( 
            6368419127728881506865199276537851570627288771807564146923401656747532875984,
            16395562287936545041879557505439929822721823239430957294654915729599249360129
        );                                      
        
        vk.IC[25] = ProofLib.G1Point( 
            7782395175608617775215517776118767941640115685543127346329213073785003192785,
            17154103324218310994443737665726360630741908565573857082771621922114177989517
        );                                      
        
        vk.IC[26] = ProofLib.G1Point( 
            2350128246091276371322219080472901487379172867433840358724502171195369646740,
            10152313280473469469698917029283119493469550694684141924244982982167389262496
        );                                      
        
        vk.IC[27] = ProofLib.G1Point( 
            4771543589195563919742084947692130388079136267431978221763156201006356543133,
            2900760247481839018760588311473534053563891530776257271362007010240348186589
        );                                      
        
        vk.IC[28] = ProofLib.G1Point( 
            218516931326662999280131825690182864538585071346231821802859134972764723704,
            2143961803075426505083483473640648627823797912851508246213452306360812576905
        );                                      
        
        vk.IC[29] = ProofLib.G1Point( 
            12859633052817925082528314861651225883800834401727923625354221848902497617731,
            11496856788165173453979154601284106950574244192517113114393994073975330336124
        );                                      
        
        vk.IC[30] = ProofLib.G1Point( 
            14223321447253477432183106270048895373571311864464476312135346103143206925066,
            6054285950027366398807687809052005425150260056633189233786054503446620864405
        );                                      
        
        vk.IC[31] = ProofLib.G1Point( 
            8338102722199536564197940559545396297200364999986632284589795493528521419989,
            12506248910696282260069892417639608197229784656863759545085960122933190708499
        );                                      
        
        vk.IC[32] = ProofLib.G1Point( 
            5705019315219225792858205021018570064433975951046752626306382483178241937070,
            18483059191763144628929757878550288599036002291000201363928610606097896029434
        );                                      
        
        vk.IC[33] = ProofLib.G1Point( 
            17631017076945975988533214353510281534300278663395145683232247030262574734418,
            9054524152750401875701122747323588105592924415418899097601322426839057866879
        );                                      
        
        vk.IC[34] = ProofLib.G1Point( 
            9117418707129885543145734668461697204814063589716278367040302209529358215585,
            10360148493641410036846745816388831845248037666467594791235339727948067457911
        );                                      
        
        vk.IC[35] = ProofLib.G1Point( 
            10715934169548744119325097189369960758902632186090614308837518874543719673206,
            18934023239425363940624415435404516038626347461520703588141034670016459073496
        );                                      
        
        vk.IC[36] = ProofLib.G1Point( 
            9961636292476815556578333618254736780591215121458495368176208909224047849090,
            3212182014729694910125671045105343555494890084674742952451567505341848485275
        );                                      
        
        vk.IC[37] = ProofLib.G1Point( 
            9485809980591725702152200148306958258119222399715559297183675083300650523118,
            8119365751369944572931674007621422712180969745610538159959018921105563271605
        );                                      
        
        vk.IC[38] = ProofLib.G1Point( 
            18089547299829789236598682898448612241686152880376789393020887299959307214974,
            17084845983181366725813189403111102178797165900596278844035931835709184732434
        );                                      
        
        vk.IC[39] = ProofLib.G1Point( 
            11661257465028824821282695446052977826250664584428253827291559345154146646387,
            14511446617550180630505943078820487445042254187572938754844524271467031402297
        );                                      
        
        vk.IC[40] = ProofLib.G1Point( 
            13549687576297034514183516916705048389821117529013067187347346368329206445201,
            20691931342838441907301199262513500443704675572020464421749571454883311281842
        );                                      
        
        vk.IC[41] = ProofLib.G1Point( 
            16234574707178698269721735234853121047684112779541596934036612534579329013056,
            3159064114417723766358426700832418245817275991001822050947797050499134984787
        );                                      
        
        vk.IC[42] = ProofLib.G1Point( 
            2153756042163155142483450455866437296328866611224180441578900941724518804778,
            1789784249744804492290135694943581284575237800051106314851054100256996454432
        );                                      
        
        vk.IC[43] = ProofLib.G1Point( 
            554100393326613083745296176570017912530672230635544211759069469441331876859,
            19956740505922873701598874190731505804260342615535788982629940961494962492935
        );                                      
        
        vk.IC[44] = ProofLib.G1Point( 
            16062264033567584840921260672357548137088901748273771986089268490488671612354,
            9905190891819724746131625863269477487253094756626439216325537020354654810773
        );                                      
        
        vk.IC[45] = ProofLib.G1Point( 
            21869318296835112832177454206349987080731396146919856359422757793830697951518,
            20059023643057316180768084128377055022003419145581053858555074790768736069693
        );                                      
        
        vk.IC[46] = ProofLib.G1Point( 
            747416041719915061231062124916199382029692298657506637466369621241089054529,
            4036341354221656728275634100404652450479742882513294965166610179660617985632
        );                                      
        
        vk.IC[47] = ProofLib.G1Point( 
            4086359736593682355550494816434437307280048116248998350773311007462062497153,
            5015742220953103839526723558763824965444530877084089674095935194744846375328
        );                                      
        
        vk.IC[48] = ProofLib.G1Point( 
            21783391574089846471573056374200869533971587035439331798641674141136874921403,
            11520405849079897796176252207620904561002725077265634858185310978347561423827
        );                                      
        
        vk.IC[49] = ProofLib.G1Point( 
            6035087771389837489118609190864753678101682392915139243658728288435571376087,
            3470426966737611526583591864364153546448878710989242844008898283239996975147
        );                                      
        
        vk.IC[50] = ProofLib.G1Point( 
            4599718019484332018928127349214782529503785271595227478985963938028831740439,
            6661298864613287378629905602288270617955031370698837088781077065497623034994
        );                                      
        
        vk.IC[51] = ProofLib.G1Point( 
            8201522135592558713892804917370689978521681745706041940223308064359835721677,
            12470940405976541581724236443016023120011377679942221371672182628302527855262
        );                                      

    }

    function _verifyMassUpdateProof(
        uint[8] calldata p,
        uint[51] memory input
    ) internal view returns (bool) {
        ProofLib.Proof memory proof;
        proof.A = ProofLib.G1Point(p[0], p[1]);
        proof.B = ProofLib.G2Point([p[2], p[3]], [p[4], p[5]]);
        proof.C = ProofLib.G1Point(p[6], p[7]);
        ProofLib.VerifyingKey memory vk = massUpdateVerifyingKey();
        ProofLib.G1Point memory vk_x = ProofLib.G1Point(0, 0);
        for (uint i = 0; i < 51;) {
            if (input[i] >= ProofLib.snark_scalar_field)
                revert ProofLib.GteSnarkScalarField();
            vk_x = vk_x.addition(vk.IC[i+1].scalar_mul(input[i]));
            unchecked { i += 1; }
        }
        vk_x = vk_x.addition(vk.IC[0]);
        return proof.A.negate().pairingProd4(
            proof.B,
            vk.alfa1,
            vk.beta2,
            vk_x,
            vk.gamma2,
            proof.C,
            vk.delta2
        );
    }

}